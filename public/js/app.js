"use strict";var _get=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(i):void 0},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wrt(e){console.log(e)}function throttle(e,t,n){var i,o;return t||(t=250),function(){var a=n||this,r=+new Date,s=arguments;i&&r<i+t?(clearTimeout(o),o=setTimeout(function(){i=r,e.apply(a,s)},t)):(i=r,e.apply(a,s))}}function findTargetInPath(e,t){var n=!0,i=!1,o=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(s.classList.contains(e))return s;if("BODY"===s.tagName)return null}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}}window.editor={events:{},addEventListener:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},removeEventListener:function(e){this.events[e]&&(this.events[e]=[])},emit:function(e,t){var n=this;this.events[e]&&this.events[e].forEach(function(e){return e.call(n,t)})}};var Modal=function(){function e(t){_classCallCheck(this,e),this.modal=t,this.docBody=document.querySelector("body")}return _createClass(e,[{key:"closeAnimEnd",value:function(){this.modal.classList.contains("fadeIn")?(this.modal.classList.remove("fadeIn"),this.docBody.classList.add("modal-opened")):this.modal.classList.contains("fadeOut")&&(this.modal.style.display="none",this.modal.classList.remove("fadeOut"),this.docBody.classList.remove("modal-opened"))}},{key:"open",value:function(){this.modal.style.display="flex",this.modal.classList.remove("fadeOut"),this.modal.classList.add("fadeIn")}},{key:"close",value:function(){this.modal.classList.remove("fadeIn"),this.modal.classList.add("fadeOut")}},{key:"init",value:function(){var e=this;this.modal.querySelector(".js-modal-close").addEventListener("click",function(){e.close()}),this.modal.addEventListener("webkitAnimationEnd",function(){e.closeAnimEnd()}),this.modal.addEventListener("animationend",function(){e.closeAnimEnd()}),window.addEventListener("click",function(t){t.target===e.modal&&e.close()})}}]),e}(),Preloader=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,document.createElement("div")));e.modal.classList.add("preloader","modal");var n=new Image;return n.src="https://raw.githubusercontent.com/Avonavi232/HJ-15-d/master/res/preloader.gif",e.modal.appendChild(n),document.querySelector("body").appendChild(e.modal),e.init(),e}return _inherits(t,Modal),_createClass(t,[{key:"init",value:function(){var e=this;this.modal.addEventListener("webkitAnimationEnd",function(){e.closeAnimEnd()}),this.modal.addEventListener("animationend",function(){e.closeAnimEnd()})}}]),t}(),preloader=new Preloader,Server=function(){function e(){_classCallCheck(this,e),this.art=null,this.baseurl="https://neto-api.herokuapp.com/yellowgallery/",this.oldurl="./src/js/feed.json",this.wssBaseUrl="wss://neto-api.herokuapp.com/yellowgallery/"}return _createClass(e,[{key:"getFeed",value:function(){return fetch(this.baseurl,{method:"GET"})}},{key:"getCard",value:function(e){return fetch(this.baseurl+e,{method:"GET"}).then(function(e){return e.json()})}},{key:"uploadItem",value:function(e){return fetch(this.baseurl,{method:"POST",body:e}).then(function(e){return e.json()})}},{key:"likeItem",value:function(e){if(e){var t=Math.floor(10*Math.random());return fetch(this.baseurl+e+"/likes/"+t,{method:"PUT"}).then(function(e){return e.json()})}}},{key:"commentItem",value:function(e,t,n){if(e)return fetch(this.baseurl+e+"/comments",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"uid="+encodeURIComponent(t)+"&message="+encodeURIComponent(n)}).then(function(e){return e.json()})}},{key:"seeItem",value:function(e){if(e)return fetch(this.baseurl+e+"/seen/"+Date.now(),{method:"PUT"}).then(function(e){return e.json()})}},{key:"artInit",value:function(e){var t=this,n=new WebSocket(this.wssBaseUrl+e);return n.addEventListener("open",function(){wrt("Соединение установлено.")}),n.addEventListener("close",function(e){e.wasClean?wrt("Соединение закрыто чисто"):wrt("Обрыв соединения"),wrt("Код: "+e.code+" причина: "+e.reason)}),n.addEventListener("message",function(e){wrt("Получены данные "),wrt(JSON.parse(e.data))}),n.addEventListener("error",function(e){wrt("Ошибка "+e.message),t.socket=null}),n}},{key:"getMask",value:function(e){if(e)return new Promise(function(t,n){fetch("https://neto-api.herokuapp.com/yellowgallery/"+e+"/mask/"+Date.now(),{method:"GET"}).then(function(e){200<=e.status&&e.status<300?t(e.blob()):n()})})}},{key:"sendCanvas",value:function(e,t){var n=this;return new Promise(function(i,o){e.toBlob(function(e){var o=new FormData;o.append("image",e),fetch(n.baseurl+t+"/mask ",{method:"PUT",body:o}).then(function(e){i(e.json())})})})}},{key:"sendCanvasSocket",value:function(e,t){e.toBlob(function(e){t.send(e)})}}]),e}(),connection=new Server,ImageSidebar=function(){function e(t){var n=this;_classCallCheck(this,e),this.sidebarToggleHandler=function(e){findTargetInPath("js-image-sidebar-toggle",e.path)&&n.toggle()},this.sidebar=document.querySelector("."+t.sidebar),this.art=document.querySelector("."+t.art),this.descr=document.querySelector("."+t.descr),this.state=!0,this.toggleButtons=document.querySelectorAll(".js-image-sidebar-toggle")}return _createClass(e,[{key:"toggle",value:function(){this.state?(this.descr.style.transform="translateX(600px)",this.art.style.transform="translateX(0px)",this.state=!1):(this.descr.style.transform="translateX(0px)",this.art.style.transform="translateX(-600px)",this.state=!0)}},{key:"init",value:function(){this.sidebar.addEventListener("click",this.sidebarToggleHandler)}}]),e}(),imageSidebar=new ImageSidebar({sidebar:"image-sidebar",art:"image-art",descr:"image-infoblock"});imageSidebar.init();var ImageLoader=function(){function e(t){_classCallCheck(this,e),this.dropArea=t,this.dropAreaInner=this.dropArea.firstElementChild,this.inputReplacer=document.querySelector(".js-upload-input-replacer"),this.input=document.querySelector(".js-upload-input"),this.preview=document.querySelector(".js-upload-image-preview"),this.form=document.querySelector(".js-upload-form"),this.imgToUpload=null,this.modalOpenBtn=document.querySelector(".js-upload-pic-btn"),this.modalUploadCancelBtn=document.querySelector(".js-upload-cancel"),this.modalUploadSubmitBtn=document.querySelector(".js-upload-form-submit"),this.modal=new Modal(document.querySelector(".js-upload-modal")),this.modal.init(),this.errorField=document.querySelector(".js-error")}return _createClass(e,[{key:"getPreviewImg",value:function(e){if(e.length&&-1!==e[0].type.indexOf("image"))return URL.createObjectURL(e[0])}},{key:"showPreviewImg",value:function(e){var t=document.createElement("img");t.src=e,t.addEventListener("load",function(e){URL.revokeObjectURL(e.target.src)}),this.removePreviewImg(),this.preview.appendChild(t)}},{key:"removePreviewImg",value:function(){this.preview.textContent=""}},{key:"showPreviewInfo",value:function(){var e=document.createElement("form");e.classList.add("upload-infoblock");var t=document.createElement("div");t.classList.add("justified"),e.appendChild(t);var n=document.createElement("label");n.setAttribute("for","label-upload-uid"),n.textContent="Опубликовать от имени автора:",t.appendChild(n);var i=document.createElement("input");i.id="label-upload-uid",i.name="uid",i.classList.add("js-upload-uid"),t.appendChild(i);var o=document.createElement("div");o.classList.add("justified"),e.appendChild(o);var a=document.createElement("label");a.setAttribute("for","label-upload-description"),a.textContent="Описание изображения:",o.appendChild(a);var r=document.createElement("textarea");r.id="label-upload-description",r.name="description",r.classList.add("js-upload-description"),o.appendChild(r),this.preview.appendChild(e)}},{key:"uploadCancel",value:function(){this.modal.close(),this.removePreviewImg()}},{key:"upload",value:function(){var e=this;if(this.imgToUpload)if(this.uidInput.value)if(-1!==this.imgToUpload.type.indexOf("png")){preloader.open();var t=new FormData(this.preview.querySelector("form"));t.append("image",this.imgToUpload),connection.uploadItem(t).then(function(){preloader.close(),e.modal.close(),e.removePreviewImg()})}else this.errorField.textContent="You can only upload an PNG image";else this.errorField.textContent="Enter the UID!";else this.errorField.textContent="Attach an image!"}},{key:"init",value:function(){var e=this;this.input.addEventListener("change",function(t){if(t.preventDefault(),-1!==t.target.files[0].type.indexOf("png")){e.errorField.textContent="",e.imgToUpload=t.target.files[0];var n=e.getPreviewImg(t.currentTarget.files);e.showPreviewImg(n),e.showPreviewInfo()}else e.errorField.textContent="You can only upload an PNG image"}),this.dropArea.addEventListener("drop",function(t){if(t.preventDefault(),-1!==t.dataTransfer.files[0].type.indexOf("png")){e.errorField.textContent="";var n=e.getPreviewImg(t.dataTransfer.files);e.imgToUpload=t.dataTransfer.files[0],e.showPreviewImg(n),e.showPreviewInfo(),e.dropArea.classList.remove("upload-modal__drop-area_dragover")}else e.errorField.textContent="You can only upload an PNG image"}),this.dropArea.addEventListener("dragover",function(t){t.preventDefault(),t.target!==e.dropArea&&t.target!==e.dropAreaInner||e.dropArea.classList.add("upload-modal__drop-area_dragover")}),this.inputReplacer.addEventListener("click",function(){e.input.click()}),this.dropArea.addEventListener("click",function(){e.input.click()}),this.modalOpenBtn.addEventListener("click",function(){e.modal.open()}),this.modalUploadCancelBtn.addEventListener("click",function(){e.uploadCancel()}),this.form.addEventListener("submit",function(t){t.preventDefault(),e.upload()})}},{key:"uidInput",get:function(){return this.form.querySelector(".js-upload-uid")}},{key:"descrInput",get:function(){return this.form.querySelector(".js-upload-description")}}]),e}(),dropArea=new ImageLoader(document.querySelector(".js-drop-area"));dropArea.init();var Feed=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"createStat",value:function(e,t){var n=document.createElement("td"),i=document.createElement("p");i.classList.add("stat"),n.appendChild(i);var o=document.createElement("span");o.classList.add(e),i.appendChild(o);var a=document.createElement("span");return a.textContent=t,i.appendChild(a),n}},{key:"createCard",value:function(t){var n=t.likes?Object.keys(t.likes).length:0,i=t.comments?Object.keys(t.comments).length:0,o=t.seen?Object.keys(t.seen).length:0,a=t.art?Object.keys(t.art).length:0,r=document.createElement("div");r.classList.add("card-thumbnail"),r.dataset.id=t.id;var s=document.createElement("div");s.classList.add("card-thumbnail__overlay"),r.appendChild(s);var c=document.createElement("div");c.classList.add("card-thumbnail__stats","stats"),r.appendChild(c);var l=document.createElement("table");c.appendChild(l);var d=document.createElement("tr");d.appendChild(e.createStat("icon-heart",n)),d.appendChild(e.createStat("icon-bubble",i)),l.appendChild(d.cloneNode(!0)),d.textContent="",d.appendChild(e.createStat("icon-eye",o)),d.appendChild(e.createStat("icon-pencil",a)),l.appendChild(d);var u=document.createElement("img");return u.src=t.url,r.appendChild(u),r}},{key:"renderFeed",value:function(t){var n=0,i=document.createDocumentFragment(),o=!0,a=!1,r=void 0;try{for(var s,c=t[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;if(0===n){var d=document.createElement("div");d.classList.add("row"),i.appendChild(d)}var u=i.lastElementChild,h=document.createElement("div");h.classList.add("col-sm-4"),u.appendChild(h),h.appendChild(e.createCard(l)),3==++n&&(n=0)}}catch(e){a=!0,r=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw r}}e.feed.textContent="",e.feed.appendChild(i)}},{key:"updFeed",value:function(){preloader.open(),connection.getFeed().then(function(e){return e.json()}).then(function(t){return e.renderFeed(t)}).then(function(){return preloader.close()})}},{key:"feed",get:function(){return document.querySelector(".js-feed")}}]),e}();Feed.updFeed();var Art=function(){function e(t,n){var i=this;_classCallCheck(this,e),this.parentModal=n,this.imgContainer=this.parentModal.pic,this.img=this.imgContainer.querySelector("img"),this.id=this.parentModal.id,this.canvas=document.createElement("canvas"),this.canvas.height=this.img.clientHeight,this.canvas.width=this.img.clientWidth,this.ctx=this.canvas.getContext("2d"),this.brushColorInput=t.querySelector(".art-controls-color"),this.brushWidthInput=t.querySelector(".art-controls-size"),this.brushColor=this.brushColorInput.value,this.brushWidth=this.brushWidthInput.value,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.shiftPressed=0,this.needsRepaint=!1,this.curves=[],this.mouseHolded=!1,this.socket=connection.artInit(this.id),this.socket.addEventListener("close",function(){i.socket=null}),this.socket.addEventListener("error",function(){i.socket=null}),this.artIsActive=!0,this.eventListeners=[],this.init()}return _createClass(e,[{key:"repaint",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var e=!0,t=!1,n=void 0;try{for(var i,o=this.curves[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.circle(a[0]),this.smoothCurve(a)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"circle",value:function(e){this.ctx.beginPath(),this.ctx.arc(e[0],e[1],e[3]/2,0,2*Math.PI),this.ctx.save(),this.ctx.fillStyle=e[2],this.ctx.lineWidth=e[3],this.ctx.fill(),this.ctx.restore()}},{key:"smoothCurveBetween",value:function(e,t){var n=(e[0]+t[0])/2,i=(e[1]+t[1])/2;this.ctx.quadraticCurveTo(e[0],e[1],n,i)}},{key:"smoothCurve",value:function(e){this.ctx.beginPath(),this.ctx.moveTo(e[0][0],e[0][1]);for(var t=1;t<e.length-1;t++)this.smoothCurveBetween(e[t],e[t+1]);this.ctx.strokeStyle=e[e.length-1][2],this.ctx.lineWidth=e[e.length-1][3],this.ctx.stroke()}},{key:"tick",value:function(){var e=this;this.shiftPressedControl(),this.needsRepaint&&(this.repaint(),this.needsRepaint=!1),window.requestAnimationFrame(function(){e.artIsActive&&e.tick()})}},{key:"shiftPressedControl",value:function(){var e=this;document.addEventListener("keydown",function(t){t.shiftKey?e.shiftPressed=1:e.shiftPressed=0}),document.addEventListener("keyup",function(t){t.shiftKey?e.shiftPressed=1:e.shiftPressed=0})}},{key:"checkBoundaries",value:function(e){return e!==this.canvas?0:1}},{key:"createMask",value:function(e){var t=new Image;window.URL||window.webkitURL;return t.src=e,t.crossOrigin="Anonymous",t.classList.add("js-mask"),t.style.width=this.canvas.width+"px",t.style.height=this.canvas.height+"px",t}},{key:"updMask",value:function(e){var t=this.createMask(e),n=this.imgContainer.querySelector(".js-mask");n&&n.remove(),this.imgContainer.insertBefore(t,this.canvas)}},{key:"sendMask",value:function(e){var t=this;e.toBlob(function(e){t.socket&&t.socket.send(e)})}},{key:"createMaskLink",value:function(e){return e.substr(0,e.indexOf("nocache")-1)}},{key:"stopArt",value:function(){this.socket&&this.socket.close(),delete this.socket,this.artIsActive=!1,this.eventListeners.length&&this.eventListeners.forEach(function(e){e.object.removeEventListener(e.type,e.listener)})}},{key:"mergeCanvasWithMask",value:function(e){var t=this.canvas.cloneNode(!1);return t.getContext("2d").drawImage(e,0,0),t}},{key:"canvasUpdateHandler",value:function(e){if(this.socket&&1===this.socket.readyState){var t=this.imgContainer.querySelector(".js-mask"),n=t?this.mergeCanvasWithMask(t):e;this.sendMask(n)}}},{key:"socketMessageHandler",value:function(e){var t=JSON.parse(e.data);if("mask"===t.event){var n=t.url,i=this.createMaskLink(n);this.updMask(i)}}},{key:"init",value:function(){var e=this;this.imgContainer.appendChild(this.canvas),this.shiftPressedControl(),window.addEventListener("resize",function(){e.ctx.lineJoin="round",e.ctx.lineCap="round",e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height)}),this.canvas.addEventListener("mousedown",function(t){t.preventDefault(),e.mouseHolded=!0;var n=[];n.push([t.offsetX,t.offsetY,e.brushColor,e.brushWidth]),e.curves.push(n),e.needsRepaint=!0}),document.addEventListener("mouseup",function(){e.mouseHolded&&(window.editor.emit("update",e.canvas),e.mouseHolded=!1)}),this.canvas.addEventListener("mousemove",function(t){t.preventDefault(),e.mouseHolded&&(e.curves[e.curves.length-1].push([t.offsetX,t.offsetY,e.brushColor,e.brushWidth]),e.needsRepaint=!0)}),this.canvas.addEventListener("dblclick",function(t){t.preventDefault(),e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.curves=[]}),this.brushColorInput.addEventListener("change",function(t){e.brushColor=t.target.value}),this.brushWidthInput.addEventListener("change",function(t){e.brushWidth=t.target.value});var t=this.canvasUpdateHandler.bind(this);if(this.eventListeners.push({object:window.editor,type:"update",listener:t}),window.editor.addEventListener("update",t),this.socket){var n=this.socketMessageHandler.bind(this);this.eventListeners.push({object:this.socket,type:"message",listener:n}),this.socket.addEventListener("message",n)}this.tick()}}]),e}(),ShowPicModal=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.pic=e.querySelector(".js-image-natural"),n.likes=e.querySelector(".js-image-like-counter"),n.comments=e.querySelector(".js-image-comment-counter"),n.seen=e.querySelector(".js-image-seen-counter"),n.art=e.querySelector(".js-art-counter"),n.author=e.querySelector(".js-image-author"),n.postDate=e.querySelector(".js-image-date"),n.tags=e.querySelector(".js-image-hashtags"),n.commentsList=e.querySelector(".image-comments"),n.description=e.querySelector(".js-image-description"),n.commentForm=e.querySelector(".js-comment-form"),n.commentUID=e.querySelector(".js-comment-uid"),n.commentUID.value=localStorage.getItem("YellowGalleryUserName")||"",n.errorField=e.querySelector(".js-comment-error"),n.commentMessage=e.querySelector(".js-comment-message"),n.controlsInited=!1,n.id=null,n.controlsInited=!1,n.artObject=null,n.hasMask=!1,n}return _inherits(t,Modal),_createClass(t,[{key:"renderComment",value:function(e,t){var n=document.createElement("div");n.classList.add("image-comment");var i=document.createElement("span");i.classList.add("image-comment-author"),i.textContent=e+": ",n.appendChild(i);var o=document.createElement("span");return o.classList.add("image-comment-body"),o.textContent=t,n.appendChild(o),n}},{key:"updateModalStatsComments",value:function(e){var t=this;return connection.getCard(e).then(function(e){t.likes.textContent=e.likes?Object.keys(e.likes).length:0,t.comments.textContent=e.comments?Object.keys(e.comments).length:0,t.seen.textContent=e.seen?Object.keys(e.seen).length:0,t.art.textContent=e.art?Object.keys(e.art).length:0,t.commentsList.textContent="";for(var n in e.comments)t.commentsList.appendChild(t.renderComment(e.comments[n].uid,e.comments[n].message))})}},{key:"updateModalData",value:function(e){var t=this;return connection.getCard(e.dataset.id).then(function(e){t.pic.textContent="";var n=document.createElement("img");return n.src=e.url,t.pic.appendChild(n),e}).then(function(e){return t.likes.textContent=e.likes?Object.keys(e.likes).length:0,t.comments.textContent=e.comments?Object.keys(e.comments).length:0,t.seen.textContent=e.seen?Object.keys(e.seen).length:0,t.art.textContent=e.art?Object.keys(e.art).length:0,e}).then(function(e){t.author.textContent=e.uid,t.postDate.textContent=new Date(e.timestamp).toLocaleString(),t.description.textContent=e.description,e.hasOwnProperty("mask")&&(t.hasMask=!0);for(var n in e.comments)t.commentsList.appendChild(t.renderComment(e.comments[n].uid,e.comments[n].message))})}},{key:"showPic",value:function(e){var t=this;preloader.open(),this.id=e.dataset.id,connection.seeItem(this.id).then(function(){t.updateModalData(e).then(function(){t.controlsInited||(t.initControls(),t.controlsInited=!0)}).then(function(){t.open()}).then(function(){preloader.close()})})}},{key:"open",value:function(){this.img=this.pic.querySelector("img"),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this)}},{key:"close",value:function(){this.pic.textContent="",this.likes.textContent="",this.comments.textContent="",this.seen.textContent="",this.art.textContent="",this.author.textContent="",this.postDate.textContent="",this.tags.textContent="",this.commentsList.textContent="",this.description.textContent="",this.controlsInited=!1,this.artObject&&this.artObject.stopArt(),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"initControls",value:function(){var e=this;this.controlsInited||(this.modal.querySelector(".js-image-like").addEventListener("click",function(t){t.preventDefault(),preloader.open(),connection.likeItem(e.id).then(function(){e.updateModalStatsComments(e.id).then(function(){preloader.close()})})}),this.commentForm.addEventListener("submit",function(t){t.preventDefault(),e.commentUID.value&&e.commentMessage.value?(e.errorField.textContent="",preloader.open(),localStorage.setItem("YellowGalleryUserName",e.commentUID.value),connection.commentItem(e.id,e.commentUID.value,e.commentMessage.value).then(function(){e.updateModalStatsComments(e.id),e.commentMessage.value="",preloader.close()})):e.errorField.textContent="Не все поля заполнены"}))}},{key:"init",value:function(){var e=this;document.querySelector(".js-art-on").addEventListener("click",function(t){e.pic;var n=e.modal.querySelector(".image-art");e.artObject=new Art(n,e)}),document.querySelector(".js-art-off").addEventListener("click",function(t){e.pic.textContent="",e.pic.appendChild(e.img),e.artObject.stopArt(),e.artObject.active=!1}),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}}]),t}(),showPicModal=new ShowPicModal(document.querySelector(".js-show-pic-modal"));showPicModal.init(),document.querySelector(".js-feed").addEventListener("click",function(e){var t=findTargetInPath("card-thumbnail",e.path);t&&showPicModal.showPic(t)});